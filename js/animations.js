animations = {
  "moveTube": {
    "props": "moveTube 0.5s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "top": "63%"
      }
    }
  },
  "closeCap": {
    "props": "closeCap 0.5s linear normal forwards",
    "keyframes": {
      "0%": {
        "transform": "rotate(-135deg)"
      },
      "100%": {
        "transform": "rotate(0deg)"
      }
    }
  },
  "tubeDown": {
    "props": "tubeDown 0.5s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "63%"
      },
      "100%": {
        "top": "70%"
      }
    }
  },
  "movePipette": {
    "props": "movePipette 8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "0.5%",
        "top": "52%"
      },
      "10%": {
        "left": "0.5%",
        "top": "35%"
      },
      "40%": {
        "left": "52%",
        "top": "35%"
      },
      "50%": {
        "left": "52%",
        "top": "41.6%"
      },
      "80%": {
        "left": "82.5%",
        "top": "47%"
      },
      "90%": {
        "left": "83%",
        "top": "32%"
      },
      "100%": {
        "left": "86.4%",
        "top": "40.8%"
      }
    }
  },
  "removeLid": {
    "props": "removeLid 0.9s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "21.58%",
        "left": "59.88%",
        "transform": "rotate(0deg)"
      },
      "10%": {
        "top": "18.5%"
      },
      "25%": {
        "top": "16.7%",
        "transform": "rotate(20deg)"
      },
      "100%": {
        "top": "11.6%",
        "left": "70%",
        "transform": "rotate(86deg)"
      }
    }
  },
  "replaceLid": {
    "props": "replaceLid 0.9s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "11.6%",
        "left": "70%",
        "transform": "rotate(86deg)"
      },
      "10%": {
        "top": "16.7%",
        "transform": "rotate(20deg)"
      },
      "25%": {
        "top": "18.5%"
      },
      "100%": {
        "top": "21.58%",
        "left": "59.88%",
        "transform": "rotate(0deg)"
      }
    }
  },
  "flickTube": {
    "props": "flickTube 0.6s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "63%",
        "transform": "rotate(0deg)"
      },
      "25%": {
        "top": "63%",
        "transform": "rotate(90deg)"
      },
      "50%": {
        "top": "63%",
        "transform": "rotate(0deg)"
      },
      "75%": {
        "top": "63%",
        "transform": "rotate(90deg)"
      },
      "100%": {
        "top": "63%",
        "transform": "rotate(0deg)"
      }
    }
  },
  "tapTube": {
    "props": "tapTube 1.6s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "63%"
      },
      "35%": {
        "top": "72.3%",
        "left": "32%"
      },
      "45%": {
        "top": "67%",
        "left": "32%"
      },
      "55%": {
        "top": "72.3%",
        "left": "32%"
      },
      "65%": {
        "top": "67%",
        "left": "32%"
      },
      "75%": {
        "top": "72.3%",
        "left": "32%"
      },
      "85%": {
        "top": "67%",
        "left": "32%"
      },
      "100%": {
        "top": "63%"
      }
    }
  },
  "PrepPipette": {
    "props": "PrepPipette 1s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "14.5%",
        "top": "52%"
      },
      "100%": {
        "left": "24.5%",
        "top": "38%"
      }
    }
  },
  "pipetteFromBinToPrep": {
    "props": "pipetteFromBinToPrep 1.6s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "57.7%",
        "top": "34.7%"
      },
      "100%": {
        "left": "24.5%",
        "top": "38%"
      }
    }
  },
  "tipReset": {
    "props": "tipReset .1s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {},
      "100%": {
        "left": "54.7%",
        "top": "96%"
      }
    }
  },
  "addTip1": {
    "props": "addTip1 3s linear 0s 1 normal forwards",
    "keyframes": {
      "0": {},
      "100%": {
        "left": "86.4%",
        "top": "28%"
      }
    }
  },
  "pipetteBacktoNormal": {
    "props": "pipetteBacktoNormal 2s linear 0s 1 normal forwards",
    "keyframes": {
      "60%": {
        "left": "27.5%",
        "top": "40%"
      },
      "100%": {
        "left": "14.5%",
        "top": "52%"
      }
    }
  },
  "addTipp1": {
    "props": "addTipp1 3s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "22.9%",
        "top": "5.4%"
      }
    }
  },
  "addTip2": {
    "props": "addTip2 5s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "1.5%",
        "top": "52%"
      },
      "90%": {
        "left": "17%",
        "top": "47.6%"
      },
      "100%": {
        "left": "17%",
        "top": "42%"
      }
    }
  },
  "lowerPipette": {
    "props": "lowerPipette 0.4s linear 0s normal forwards",
    "keyframes": {
      "0%": {
        "left": "24.5%",
        "top": "38%"
      },
      "100%": {
        "left": "27.5%",
        "top": "40%"
      }
    }
  },
  "moveTip1": {
    "props": "moveTip1 5s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "20.8%",
        "top": "70%"
      },
      "20%": {
        "left": "20.8%",
        "top": "70%"
      },
      "25%": {
        "left": "20.8%",
        "top": "64.6%"
      },
      "90%": {
        "left": "85.5%",
        "top": "50.6%"
      },
      "100%": {
        "left": "88.9%",
        "top": "50.6%"
      }
    }
  },
  "tipToBin": {
    "props": "tipToBin .5s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "100%"
      },
      "10.9091%": {
        "top": "105%"
      },
      "72.72727%": {
        "top": "120%"
      },
      "90%": {
        "top": "130%"
      },
      "100%": {
        "top": "170%"
      }
    }
  },
  "pipetteToBin": {
    "props": "pipetteToBin 1.6s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {},
      "100%": {
        "left": "57.7%",
        "top": "34.7%"
      }
    }
  },
  "moveLoadingDye": {
    "props": "moveLoadingDye 2s linear 0s 1 normal forwards",
    "keyframes": {
      "15%": {
        "top": "16%",
        "left": "7.8%"
      },
      "70%": {
        "top": "16%",
        "left": "22%"
      },
      "100%": {
        "top": "28%",
        "left": "22%"
      }
    }
  },
  "moveLoadingDyeback": {
    "props": "moveLoadingDyeback 2s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "28%",
        "left": "22%"
      },
      "15%": {
        "top": "16%",
        "left": "22%"
      },
      "70%": {
        "top": "16%",
        "left": "7.8%"
      },
      "100%": {
        "top": "19.2%",
        "left": "8%"
      }
    }
  },
  "addDyeToTube": {
    "props": "addDyeToTube 3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "22.9%",
        "top": "5.4%"
      },
      "20%": {
        "left": "22.9%",
        "top": "0%"
      },
      "60%": {
        "left": "34.75%",
        "top": "15%"
      },
      "100%": {
        "left": "34.75%",
        "top": "39%"
      }
    }
  },
  "returnLoadingDye1": {
    "props": "returnLoadingDye1 2s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "28%",
        "left": "22%"
      },
      "15%": {
        "top": "16%",
        "left": "22%"
      },
      "70%": {
        "top": "16%",
        "left": "7.8%"
      },
      "100%": {
        "top": "23.2%",
        "left": "7.8%"
      }
    }
  },
  "moveLoadingDye2": {
    "props": "moveLoadingDye2 2s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "11.7%",
        "top": "23.2%"
      },
      "15%": {
        "top": "16%",
        "left": "11.7%"
      },
      "70%": {
        "top": "16%",
        "left": "26%"
      },
      "100%": {
        "top": "28%",
        "left": "27%"
      }
    }
  },
  "ejectTip": {
    "props": "ejectTip 0.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "55.3%",
        "top": "56.9%"
      },
      "100%": {
        "left": "55.3%",
        "top": "65%"
      }
    }
  },
  "tipToTube1": {
    "props": "tipToTube1 3.4s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "89%",
        "top": "57.6%"
      },
      "25%": {
        "left": "89%",
        "top": "50.6%"
      },
      "85%": {
        "left": "39.6%",
        "top": "57.6%"
      },
      "90%": {
        "left": "36.6%",
        "top": "54.2%"
      },
      "100%": {
        "left": "36.6%",
        "top": "61.5%"
      }
    }
  },
  "moveBlock": {
    "props": "moveBlock 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "30.72%",
        "top": "58.5%"
      }
    }
  },
  "tube0ToBath": {
    "props": "tube0ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "35.5%",
        "top": "70%"
      },
      "100%": {
        "left": "31.02%",
        "top": "55%"
      }
    }
  },
  "tube1ToBath": {
    "props": "tube1ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "33.52%",
        "top": "55%"
      }
    }
  },
  "tube2ToBath": {
    "props": "tube2ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "36.02%",
        "top": "55%"
      }
    }
  },
  "tube3ToBath": {
    "props": "tube3ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "38.52%",
        "top": "55%"
      }
    }
  },
  "tube4ToBath": {
    "props": "tube4ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "41.02%",
        "top": "55%"
      }
    }
  },
  "tube5ToBath": {
    "props": "tube5ToBath 1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "43.52%",
        "top": "55%"
      }
    }
  },
  "pressTube0": {
    "props": "pressTube0 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "31.02%",
        "top": "55%"
      },
      "100%": {
        "left": "31.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube1": {
    "props": "pressTube1 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "33.52%",
        "top": "55%"
      },
      "100%": {
        "left": "33.52%",
        "top": "56.3%"
      }
    }
  },
  "pressTube2": {
    "props": "pressTube2 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "36.02%",
        "top": "55%"
      },
      "100%": {
        "left": "36.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube3": {
    "props": "pressTube3 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "38.52%",
        "top": "55%"
      },
      "100%": {
        "left": "38.52%",
        "top": "56.3%"
      }
    }
  },
  "pressTube4": {
    "props": "pressTube4 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "41.02%",
        "top": "55%"
      },
      "100%": {
        "left": "41.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube5": {
    "props": "pressTube5 0.3s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "43.52%",
        "top": "55%"
      },
      "100%": {
        "left": "43.52%",
        "top": "56.3%"
      }
    }
  },
  "insertRack": {
    "props": "insertRack 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "30.72%",
        "top": "58.5%"
      },
      "70%": {
        "left": "50%",
        "top": "17%"
      },
      "80%": {
        "left": "60%",
        "top": "17%"
      },
      "100%": {
        "left": "60%",
        "top": "28%"
      }
    }
  },
  "insertTube0": {
    "props": "insertTube0 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "31.02%",
        "top": "56.3%"
      },
      "70%": {
        "left": "50.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "60.3%",
        "top": "14.8%"
      },
      "100%": {
        "left": "60.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube1": {
    "props": "insertTube1 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "33.52%",
        "top": "56.3%"
      },
      "70%": {
        "left": "52.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "62.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "62.8%",
        "top": "25.8%"
      }
    }
  },
  "insertTube2": {
    "props": "insertTube2 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "36.02%",
        "top": "56.3%"
      },
      "70%": {
        "left": "55.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "65.3%",
        "top": "14.8%"
      },
      "100%": {
        "left": "65.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube3": {
    "props": "insertTube3 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "38.52%",
        "top": "56.3%"
      },
      "70%": {
        "left": "57.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "67.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "67.8%",
        "top": "25.8%"
      }
    }
  },
  "insertTube4": {
    "props": "insertTube4 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "41.02%",
        "top": "56.3%"
      },
      "70%": {
        "left": "60.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "70.35%",
        "top": "14.8%"
      },
      "100%": {
        "left": "70.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube5": {
    "props": "insertTube5 1.8s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "left": "43.52%",
        "top": "56.3%"
      },
      "70%": {
        "left": "62.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "72.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "72.8%",
        "top": "25.8%"
      }
    }
  },
  "tipVisible": {
    "props": "tipVisible 0.1s linear 0s normal forwards",
    "keyframes": {
      "0%": {
        "visibility": "hidden"
      },
      "100%": {
        "visibility": "visible"
      }
    }
  },
  "tipHidden": {
    "props": "tipHidden 0.1s linear 0s normal forwards",
    "keyframes": {
      "0%": {
        "visibility": "visible"
      },
      "100%": {
        "visibility": "hidden"
      }
    }
  },
  "rotateCap": {
    "props": "rotateCap 0.5s linear forwards",
    "keyframes": {
      "0%": {
        "transform": "rotate(0deg)"
      },
      "100%": {
        "transform": "rotate(-135deg)"
      }
    }
  },
  "quickFadeIn": {
    "props": "quickFadeIn .125s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 0
      },
      "100%": {
        "opacity": 1
      }
    }
  },
  "slowFadeIn": {
    "props": "slowFadeIn 2s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 0
      },
      "100%": {
        "opacity": 1
      }
    }
  },
  "quickFadeOut": {
    "props": "quickFadeOut .125s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 1
      },
      "100%": {
        "opacity": 0
      }
    }
  },
  "slowFadeOut": {
    "props": "slowFadeOut 2s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 1
      },
      "100%": {
        "opacity": 0
      }
    }
  },
  "removeComb": {
    "props": "removeComb 1s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "top": "70%"
      },
      "90%": {
        "top": "66%"
      },
      "100%": {
        "top": "66%"
      }
    }
  },
  "placeItem": {
    "props": "placeTray 1s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "visibility": "hidden"
      },
      "100%": {
        "visibility": "visible"
      }
    }
  },
  "pourStain": {
    "props": "pourStain 2s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "transform": "rotate(0deg)"
      },
      "60%": {
        "transform": "rotate(105deg)"
      },
      "95%": {},
      "100%": {
        "transform": "rotate(105deg)"
      }
    }
  },
  "pourStainRev": {
    "props": "pourStainRev 2s 0s 1 linear normal forwards",
    "keyframes": {
      "0%": {
        "transform": "rotate(105deg)"
      },
      "60%": {
        "transform": "rotate(0deg)"
      },
      "95%": {},
      "100%": {
        "transform": "rotate(0deg)"
      }
    }
  },
  "moveEnz": {
    "props": "moveEnz 0.5s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "top": "54%"
      }
    }
  },
  "moveEnzBack": {
    "props": "moveEnzBack 1.5s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "top": "54%"
      },
      "100%": {
        "top": "62.7%"
      }
    }
  },
  "hideTip1": {
    "props": "hideTip1 .7s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 1
      },
      "47%": {
        "opacity": 1
      },
      "100%": {
        "opacity": 0
      }
    }
  },
  "hideTipp1": {
    "props": "hideTipp1 .9s linear 0s 1 normal forwards",
    "keyframes": {
      "0%": {
        "opacity": 1
      },
      "47%": {
        "opacity": 1
      },
      "100%": {
        "opacity": 0
      }
    }
  }

}


dynamicDefs = {
  "pipetteToTube": {
    keytemplate: {
      '0%': {
        left: '86.4%',
        top: '28%',
      },
      '5%': {
        left: '86.4%',
        top: '35%',
      },
      '25%': {
        left: '86.4%',
        top: '28%',
      },
      '80%': {
        left: 'var2%',
        top: '23%'
      },
      '90%': {
        left: 'var1%',
        top: '28%',
      },
      '100%': {
        left: 'var1%',
        top: '39%',
      }
    },
    props: "3.4s linear 0s 1 normal forwards",
    method(iteration) {
      var viewWidth = parseFloat($('#view').css("width"));
      var tubeLeft = parseFloat($(`#s${iteration}Tube`).css("left"))
      var pipWidth = parseFloat($("#micropipette2").css("width"));
      var tubeWidth = parseFloat($(`#s${iteration}Tube`).css("width"));
      var tubePos = (tubeLeft + ((tubeWidth / 7) * 4) - pipWidth / 2) / (viewWidth) * 100
      return {
        var1: tubePos,
        var2: tubePos + 10
      }
    }
  },
  "addTip1": {
    keytemplate: {
      '0%': {
        left: '24.5%',
        top: '38%',
      },
      '14%': {
        left: 'var1%',
        top: '44%',
      },
      '20%': {
        left: 'var1%',
        top: '47.6%',
      },
      '25%': {
        left: 'var1%',
        top: '42%',
      },
      '90%': {
        left: '86.4%',
        top: '28%',
      },
      '100%': {
        left: '86.4%',
        top: '28%',
      }
    },
    props: "3s linear 0s 1 normal forwards",
    method(selector) {
      console.log(selector)
      var selectedTip = selector.split("tip")[1];
      var tipLeft = parseInt($(`#${selector}`).css("left"))
      var viewWidth = parseFloat($('#view').css("width"));
      var pipetteWidth = parseFloat($('#micropipette2').css("width"));
      var tipWidth = parseFloat($("#pipetteTip1").css("width"));
      var tipPos = (tipLeft + tipWidth / 2 - (pipetteWidth) / 2) / (viewWidth) * 100
      return {
        var1: tipPos
      }
    }
  },
  "pipetteToBin": {
    keytemplate: {
      '0%': {
        left: 'var1%',
        top: '39%',
      },
      '25%': {
        left: 'var1%',
        top: '31%',
      },
      '100%': {
        left: '57.7%',
        top: '34.7%',
      }
    },
    props: "1.6s linear 0s 1 normal forwards",
    method(iteration) {
      var viewWidth = parseFloat($('#view').css("width"));
      var tubeLeft = parseFloat($(`#s${iteration}Tube`).css("left"))
      var pipWidth = parseFloat($("#micropipette2").css("width"));
      var tubeWidth = parseFloat($(`#s${iteration}Tube`).css("width"));
      var tubePos = (tubeLeft + ((tubeWidth / 7) * 4) - pipWidth / 2) / (viewWidth) * 100
      return {
        var1: tubePos
      }
    }
  }
}


function makeDynamicAnimation(name, value) {
  var animDef = dynamicDefs[name];
  console.log(animDef)
  var animation = {
    props: `${name} ${animDef.props}`,
    keyframes: JSON.parse(replaceKeys(JSON.stringify(animDef.keytemplate), animDef.method(value)))
  }
  animations[name] = animation
  console.log(animation.keyframes)
}


function replaceKeys(str, replaceArray) {
  var newString = str;
  for (i in replaceArray) {
    var re = new RegExp(i, 'g');
    newString = newString.replace(re, replaceArray[i])
  }
  return newString;
}
