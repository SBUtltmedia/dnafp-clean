animations = {
  "moveTube": {
    "props": "0.5s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "top": "63%"
      }
    }
  },
  "closeCap": {
    "props": "0.5s linear normal forwards",
    "keyframes": {

      "100%": {
        "transform": "rotate(0deg)"
      }
    }
  },
  "tubeDown": {
    "props": "0.5s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "top": "70%"
      }
    }
  },
  "movePipette": {
    "props": "8s linear 0s 1 normal forwards",
    "keyframes": {

      "10%": {
        "left": "0.5%",
        "top": "35%"
      },
      "40%": {
        "left": "52%",
        "top": "35%"
      },
      "50%": {
        "left": "52%",
        "top": "41.6%"
      },
      "80%": {
        "left": "82.5%",
        "top": "47%"
      },
      "90%": {
        "left": "83%",
        "top": "32%"
      },
      "100%": {
        "left": "86.4%",
        "top": "40.8%"
      }
    }
  },
  "removeLid": {
    "props": "0.9s linear 0s 1 normal forwards",
    "keyframes": {

      "10%": {
        "top": "18.5%"
      },
      "25%": {
        "top": "16.7%",
        "transform": "rotate(20deg)"
      },
      "100%": {
        "top": "11.6%",
        "left": "70%",
        "transform": "rotate(86deg)"
      }
    }
  },
  "replaceLid": {
    "props": "0.9s linear 0s 1 normal forwards",
    "keyframes": {

      "10%": {
        "top": "16.7%",
        "transform": "rotate(20deg)"
      },
      "25%": {
        "top": "18.5%"
      },
      "100%": {
        "top": "21%",
        "left": "61%",
        "transform": "rotate(0deg)"
      }
    }
  },
  "flickTube": {
    "props": "0.6s linear 0s 1 normal forwards",
    "keyframes": {

      "25%": {
        "top": "63%",
        "transform": "rotate(90deg)"
      },
      "50%": {
        "top": "63%",
        "transform": "rotate(0deg)"
      },
      "75%": {
        "top": "63%",
        "transform": "rotate(90deg)"
      },
      "100%": {
        "top": "63%",
        "transform": "rotate(0deg)"
      }
    }
  },
  "tapTube": {
    "props": "1.6s linear 0s 1 normal forwards",
    "keyframes": {

      "35%": {
        "top": "72.3%",
        "left": "32%"
      },
      "45%": {
        "top": "67%",
        "left": "32%"
      },
      "55%": {
        "top": "72.3%",
        "left": "32%"
      },
      "65%": {
        "top": "67%",
        "left": "32%"
      },
      "75%": {
        "top": "72.3%",
        "left": "32%"
      },
      "85%": {
        "top": "67%",
        "left": "32%"
      },
      "100%": {
        "top": "63%"
      }
    }
  },
  "PrepPipette": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "24.5%",
        "top": "38%"
      }
    }
  },
  "pipetteBacktoNormal": {
    "props": "2s linear 0s 1 normal forwards",
    "keyframes": {
      "60%": {
        "left": "27.5%",
        "top": "40%"
      },
      "100%": {
        "left": "14.5%",
        "top": "52%"
      }
    }
  },
  "addTipp1": {
    "props": "3s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "22.9%",
        "top": "5.4%"
      }
    }
  },
  "lowerPipette": {
    "props": "0.4s linear 0s normal forwards",
    "keyframes": {

      "100%": {
        "left": "27.5%",
        "top": "40%"
      }
    }
  },
  "moveTip1": {
    "props": "5s linear 0s 1 normal forwards",
    "keyframes": {

      "20%": {
        "left": "20.8%",
        "top": "70%"
      },
      "25%": {
        "left": "20.8%",
        "top": "64.6%"
      },
      "90%": {
        "left": "85.5%",
        "top": "50.6%"
      },
      "100%": {
        "left": "88.9%",
        "top": "50.6%"
      }
    }
  },
  "tipToBin": {
    "props": ".25s linear 0s 1 normal forwards",
    "keyframes": {

      "10.9091%": {
        "top": "100%"
      },
      "100%": {
        "top": "115%"
      },
    }
  },
  "pipetteToBin": {
    "props": "1.6s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "57.7%",
        "top": "34.7%"
      }
    }
  },
  "moveLoadingDye": {
    "props": "2s linear 0s 1 normal forwards",
    "keyframes": {
      "15%": {
        "top": "16%",
        "left": "7.8%"
      },
      "70%": {
        "top": "16%",
        "left": "22%"
      },
      "100%": {
        "top": "26%",
        "left": "22%"
      }
    }
  },
  "moveLoadingDyeback": {
    "props": "2s linear 0s 1 normal forwards",
    "keyframes": {

      "15%": {
        "top": "16%",
        "left": "22%"
      },
      "70%": {
        "top": "16%",
        "left": "7.8%"
      },
      "100%": {
        "top": "19.2%",
        "left": "8%"
      }
    }
  },
  "returnLoadingDye1": {
    "props": "2s linear 0s 1 normal forwards",
    "keyframes": {

      "15%": {
        "top": "16%",
        "left": "22%"
      },
      "70%": {
        "top": "16%",
        "left": "7.8%"
      },
      "100%": {
        "top": "23.2%",
        "left": "7.8%"
      }
    }
  },
  "moveLoadingDye2": {
    "props": "2s linear 0s 1 normal forwards",
    "keyframes": {

      "15%": {
        "top": "16%",
        "left": "11.7%"
      },
      "70%": {
        "top": "16%",
        "left": "26%"
      },
      "100%": {
        "top": "28%",
        "left": "27%"
      }
    }
  },
  "ejectTip": {
    "props": "0.8s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "55.3%",
        "top": "65%"
      }
    }
  },
  "tipToTube1": {
    "props": "3.4s linear 0s 1 normal forwards",
    "keyframes": {

      "25%": {
        "left": "89%",
        "top": "50.6%"
      },
      "85%": {
        "left": "39.6%",
        "top": "57.6%"
      },
      "90%": {
        "left": "36.6%",
        "top": "54.2%"
      },
      "100%": {
        "left": "36.6%",
        "top": "61.5%"
      }
    }
  },
  "moveBlock": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "30.72%",
        "top": "58.5%"
      }
    }
  },
  "tube0ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "31.02%",
        "top": "55%"
      }
    }
  },
  "tube1ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "33.52%",
        "top": "55%"
      }
    }
  },
  "tube2ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "36.02%",
        "top": "55%"
      }
    }
  },
  "tube3ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "38.52%",
        "top": "55%"
      }
    }
  },
  "tube4ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "41.02%",
        "top": "55%"
      }
    }
  },
  "tube5ToBath": {
    "props": "1s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "left": "43.52%",
        "top": "55%"
      }
    }
  },
  "pressTube0": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "31.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube1": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "33.52%",
        "top": "56.3%"
      }
    }
  },
  "pressTube2": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "36.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube3": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "38.52%",
        "top": "56.3%"
      }
    }
  },
  "pressTube4": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "41.02%",
        "top": "56.3%"
      }
    }
  },
  "pressTube5": {
    "props": "0.3s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "left": "43.52%",
        "top": "56.3%"
      }
    }
  },
  "insertRack": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "50%",
        "top": "17%"
      },
      "80%": {
        "left": "60%",
        "top": "17%"
      },
      "100%": {
        "left": "60%",
        "top": "28%"
      }
    }
  },
  "insertTube0": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "50.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "60.3%",
        "top": "14.8%"
      },
      "100%": {
        "left": "60.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube1": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "52.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "62.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "62.8%",
        "top": "25.8%"
      }
    }
  },
  "insertTube2": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "55.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "65.3%",
        "top": "14.8%"
      },
      "100%": {
        "left": "65.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube3": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "57.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "67.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "67.8%",
        "top": "25.8%"
      }
    }
  },
  "insertTube4": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "60.3%",
        "top": "14.8%"
      },
      "80%": {
        "left": "70.35%",
        "top": "14.8%"
      },
      "100%": {
        "left": "70.3%",
        "top": "25.8%"
      }
    }
  },
  "insertTube5": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {

      "70%": {
        "left": "62.8%",
        "top": "14.8%"
      },
      "80%": {
        "left": "72.8%",
        "top": "14.8%"
      },
      "100%": {
        "left": "72.8%",
        "top": "25.8%"
      }
    }
  },
  "tipVisible": {
    "props": "0.1s linear 0s normal forwards",
    "keyframes": {

      "100%": {
        "visibility": "visible"
      }
    }
  },
  "tipHidden": {
    "props": "0.1s linear 0s normal forwards",
    "keyframes": {

      "100%": {
        "visibility": "hidden"
      }
    }
  },

  "quickFadeIn": {
    "props": ".125s 0s 1 linear normal forwards",
    "keyframes": {

      "100%": {
        "opacity": 1
      }
    }
  },
  "slowFadeIn": {
    "props": "2s 0s 1 linear normal forwards",
    "keyframes": {
      "0": {
        "opacity": 0
      },
      "60": {
        "opacity": 0
      },
      "100%": {
        "opacity": 1
      }
    }
  },
  "removeComb": {
    "props": "1s 0s 1 linear normal forwards",
    "keyframes": {

      "90%": {
        "top": "66%"
      },
      "100%": {
        "top": "66%"
      }
    }
  },
  "placeItem": {
    "props": "1s 0s 1 linear normal forwards",
    "keyframes": {

      "100%": {
        "visibility": "visible"
      }
    }
  },
  "pourStain": {
    "props": "2s 0s 1 linear normal forwards",
    "keyframes": {

      "60%": {
        "transform": "rotate(105deg)"
      },
      "95%": {},
      "100%": {
        "transform": "rotate(105deg)"
      }
    }
  },
  "pourStainRev": {
    "props": "2s 0s 1 linear normal forwards",
    "keyframes": {

      "60%": {
        "transform": "rotate(0deg)"
      },
      "95%": {},
      "100%": {
        "transform": "rotate(0deg)"
      }
    }
  },
  "moveEnz": {
    "props": "0.5s linear 0s 1 normal forwards",
    "keyframes": {
      "100%": {
        "top": "54%"
      }
    }
  },
  "moveEnzBack": {
    "props": "1.5s linear 0s 1 normal forwards",
    "keyframes": {

      "100%": {
        "top": "62.7%"
      }
    }
  },
  "hideTip": {
    "props": ".7s linear 0s 1 normal forwards",
    "keyframes": {

      "47%": {
        "opacity": 1
      },
      "100%": {
        "opacity": 0
      }
    }
  },
  "pipetteFromBinToPrep": {
    "props": "1.7s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": '24.5%',
        "top": '38%',
      }
    }
  },
  "pipetteFromBinToOrigin": {
    "props": "1.8s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "14.5%",
        "top": "52%"
      }
    }
  },
  "resetTubeBlock": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "35.2%",
        "top": "73.0%"
      }
    }
  },
  "resetTube0": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "35.5%",
        "top": "70%"
      }
    }
  },
  "resetTube1": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "38%",
        "top": "70%"
      }
    }
  },
  "resetTube2": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "40.5%",
        "top": "70%"
      }
    }
  },
  "resetTube3": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "43%",
        "top": "70%"
      }
    }
  },
  "resetTube4": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "45.5%",
        "top": "70%"
      }
    }
  },
  "resetTube5": {
    "props": "0.1s linear 0s 1 normal forwards",
    "keyframes": {
      '100%': {
        "left": "48%",
        "top": "70%"
      }
    }
  },
  "mixFluid": {
    "props": "4s linear 0s 1 normal forwards",
    "keyframes": {
      "10%": {
        "y": "35.6"
      },
      "20%": {
        "y": "70"
      },
      "30%": {
        "y": "35.6"
      },
      "40%": {
        "y": "70"
      },
      "50%": {
        "y": "35.6"
      },
      "60%": {
        "y": "85"
      },
      "100%": {
        "y": "100"
      }
    }
  },
  "mixFluid2": {
    "props": "3.5s linear 0s 1 normal forwards",
    "keyframes": {
      "10%": {
        "y": "50"
      },
      "20%": {
        "y": "70"
      },
      "30%": {
        "y": "50"
      },
      "40%": {
        "y": "70"
      },
      "50%": {
        "y": "50"
      },
      "60%": {
        "y": "80"
      },
      "100%": {
        "y": "100"
      }
    }
  },

  "rotateCap": {
    "keyframes": {
      '100%': {
        "transform": "rotate(var1deg)"
      }
    },
    "props": "0.5s linear 0s 1 normal forwards",
    method(degrees) {
      return {
        var1: degrees
      }
    }
  },


  "pipetteToTube": {
    "keyframes": {
      '0%': {
        "left": '86.4%',
        "top": '28%',
      },
      '5%': {
        "left": '86.4%',
        "top": '35%',
      },
      '25%': {
        "left": '86.4%',
        "top": '28%',
      },
      '80%': {
        "left": 'var2%',
        "top": '23%'
      },
      '90%': {
        "left": 'var1%',
        "top": '28%',
      },
      '100%': {
        "left": 'var1%',
        "top": '39%',
      }
    },
    "props": "3.4s linear 0s 1 normal forwards",
    method(iteration) {
      var viewWidth = parseFloat($('#view').css("width"));
      var tubeLeft = parseFloat($(`#s${iteration}Tube`).css("left"))
      var pipWidth = parseFloat($("#micropipette2").css("width"));
      var tubeWidth = parseFloat($(`#s${iteration}Tube`).css("width"));
      var tubePos = (tubeLeft + ((tubeWidth / 7) * 4) - pipWidth / 2) / (viewWidth) * 100
      return {
        var1: tubePos,
        var2: tubePos + 10
      }
    }
  },
  "addTip1": {
    "keyframes": {
      '0%': {
        "left": '24.5%',
        "top": '38%',
      },
      '14%': {
        "left": 'var1%',
        "top": '44%',
      },
      '20%': {
        "left": 'var1%',
        "top": '47.6%',
      },
      '25%': {
        "left": 'var1%',
        "top": '42%',
      },
      '90%': {
        "left": '86.4%',
        "top": '28%',
      },
      '100%': {
        "left": '86.4%',
        "top": '28%',
      }
    },
    "props": "3s linear 0s 1 normal forwards",
    method(selector) {
      var selectedTip = selector.split("tip")[1];
      var tipLeft = parseInt($(`#${selector}`).css("left"))
      var viewWidth = parseFloat($('#view').css("width"));
      var pipetteWidth = parseFloat($('#micropipette2').css("width"));
      var tipWidth = parseFloat($("#pipetteTip1").css("width"));
      var tipPos = ((tipLeft + tipWidth / 2 - (pipetteWidth) / 2) / (viewWidth)) * 100 - 0.5
      return {
        var1: tipPos
      }
    }
  },
  "addTip2": {
    "keyframes": {
      '0%': {
        "left": '24.5%',
        "top": '38%',
      },
      '14%': {
        "left": 'var1%',
        "top": '44%',
      },
      '20%': {
        "left": 'var1%',
        "top": '47.6%',
      },
      '25%': {
        "left": 'var1%',
        "top": '42%',
      },
      "90%": {
        "left": "22.9%",
        "top": "1.4%"
      },
      "100%": {
        "left": "22.9%",
        "top": "5.4%"
      }
    },
    "props": "3s linear 0s 1 normal forwards",
    method(selector) {
      var selectedTip = selector.split("tip")[1];
      var tipLeft = parseInt($(`#${selector}`).css("left"))
      var viewWidth = parseFloat($('#view').css("width"));
      var pipetteWidth = parseFloat($('#micropipette2').css("width"));
      var tipWidth = parseFloat($("#pipetteTip1").css("width"));
      var tipPos = (tipLeft + tipWidth / 2 - (pipetteWidth) / 2) / (viewWidth) * 100
      return {
        var1: tipPos
      }
    }
  },
  "addDyeToTube": {
    "keyframes": {
      "20%": {
        "left": "22.9%",
        "top": "0%"
      },
      '60%': {
        "left": 'var2%',
        "top": "15%"
      },
      '90%': {
        "left": 'var1%',
        "top": '28%',
      },
      '100%': {
        "left": 'var1%',
        "top": '39%',
      }
    },
    "props": "1.75s linear 0s 1 normal forwards",
    method(iteration) {
      var viewWidth = parseFloat($('#view').css("width"));
      var tubeLeft = parseFloat($(`#s${iteration}Tube`).css("left"))
      var pipWidth = parseFloat($("#micropipette2").css("width"));
      var tubeWidth = parseFloat($(`#s${iteration}Tube`).css("width"));
      var tubePos = (tubeLeft + ((tubeWidth / 7) * 4) - pipWidth / 2) / (viewWidth) * 100
      return {
        var1: tubePos,
        var2: tubePos - 10
      }
    }
  },
  "pipetteToBin": {
    "keyframes": {
      '25%': {
        "left": 'var1%',
        "top": '31%',
      },
      '100%': {
        "left": '57.7%',
        "top": '34.7%',
      }
    },
    "props": "1.6s linear 0s 1 normal forwards",
    method(iteration) {
      var viewWidth = parseFloat($('#view').css("width"));
      var tubeLeft = parseFloat($(`#s${iteration}Tube`).css("left"))
      var pipWidth = parseFloat($("#micropipette2").css("width"));
      var tubeWidth = parseFloat($(`#s${iteration}Tube`).css("width"));
      var tubePos = (tubeLeft + ((tubeWidth / 7) * 4) - pipWidth / 2) / (viewWidth) * 100
      return {
        var1: tubePos
      }
    }
  },
  "pipetteTopToTube": {
    "keyframes": {
      '100%': {
        "left": '38.1%',
        "top": 'var1%',
      }
    },
    "props": "0.5s linear 0s 1 normal forwards",
    method(iteration) {
      var viewHeight = parseFloat($('#view').css("height"));
      var pipetteHeight = parseFloat($('#micropipetteTopView').css("height"));
      var currentTubeTop = parseFloat($(`#tubeTop_${iteration}`).css("top"))
      var tubeHeight = parseFloat($(`#tubeTop_${iteration}`).css("height"))
      var tubePos = ((currentTubeTop - pipetteHeight * 0.4) / viewHeight) * 100
      return {
        var1: tubePos
      }
    }
  },
  "pipetteTopToLane": {
    "keyframes": {
      '100%': {
        "left": 'var1%',
        "top": '70.6%',
        "z-index": 3
      }
    },
    "props": "0.5s linear 0s 1 normal forwards",
    method(iteration) {
      var laneIndex = game.iteration
      var laneLeftPosition = 12.5 //13.7
      var laneLeftAdd = 1.2
      var laneLeft = laneLeftPosition + laneLeftAdd * iteration
      return {
        var1: laneLeft
      }
    }
  },
}



function makeAnimation(name, value) {
  var animDef = animations[name];


  try {
    if (animDef.method) {
    keyframes = JSON.parse(replaceKeys(JSON.stringify(animDef.keyframes), animDef.method(value)))
    } else {
    keyframes = animDef.keyframes
    }
  } catch(err){
keyframes="df"
  }


  var animation = {
    "props": `${animDef.props}`,
    "keyframes": keyframes,

  }

  return animation
}


function replaceKeys(str, replaceArray) {
  var newString = str;
  for (i in replaceArray) {
    var re = new RegExp(i, 'g');
    newString = newString.replace(re, replaceArray[i])
  }
  return newString;
}
